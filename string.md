#字符串(string)

在4个标量类型中，对于简单的boolean、int和float这言，string类型就相对显得复杂一些，主要是因为PHP提供了多种字面表示string的方法。

##取值范围

一个 string 就是由一系列的字符组成，其中每个字符等同于一个字节。这意味着 PHP 只能支持 256 个字符的字符集，因此不支持 Unicode 。PHP中，一个string 最大可以达到 2GB。

##运算

**连接**：字符串可以用 '.'（点）运算符连接起来。

有两个字符串（string）运算符。第一个是连接运算符（“.”），它返回其左右参数连接后的字符串。第二个是连接赋值运算符（“.=”），它将右边参数附加到左边的参数之后。

**存取**：string 中的字符可以通过一个从 0 开始的下标，用类似 array 结构中的方括号包含对应的数字来访问和修改，比如 `$str[42]`。string 也可用花括号访问，比如 `$str{42}`.

##字面表式法

PHP中，string有4中表示法：

- 单引号
- 双引号
- heredoc 语法结构
- nowdoc 语法结构（自 PHP 5.3.0 起）

###单引号

单引号定义的字符串中的特殊字符的转义序列和变量将不会被解析。

但是转义序列有2个特例除外：要表达一个单引号自身，需在它的前面加个反斜线（\）来转义。要表达一个反斜线自身，则用两个反斜线（\\）。

###双引号

双引号定义的字符串中的变量会被解析。

###heredoc 语法结构

heredoc结构主要用来表示较长的一段字符串。

语法上，heredoc结构如下：

```
echo <<<EOT
My name is "$name". I am printing some $foo->foo.
Now, I am printing some {$foo->bar[1]}.
This should print a capital 'A': \x41
EOT;
```
特别注意：
- 结束标志处理可选的`;`外，不能包含除了结束标志的任何字符。
- 和双引号一样，heredoc中将进行解析。

###nowdoc 语法结构

和heredoc类型，nowdoc结构也主要用来表示较长的一段字符串，但它不进行解析。

语法上，nowdoc和heredoc的区别仅在于开始标志需用单引号括起来，示例：
```
echo <<<'EOT'	
```
##变量解析

变量解析有2种语法：

- 简单规则
- 复杂规则

简单规则适用于对变量、数组、对象进行简单解析的情况。对于更复杂的情况，简单规则无法满足需求，需要用复杂规则。

####简单规则

**变量解析**：当 PHP 解析器遇到一个美元符号（$）时，它会和其它很多解析器一样，**去组合尽量多的标识**以形成一个合法的变量名。比如：

`"$strxxx."`将尝试解析$strxxx,尽管可能$str才是正确的变量，但PHP还是会解析到最长的合法字符（.号不是合法标识符的组成字符）

**数组元素解析**：数组索引要用方括号（]）来表示索引结束的边际。

**对象属性解析**：与上述的变量规则相同。


####复杂规则

任何具有 string 表达的标量变量，数组单元或对象属性都可使用此语法。只需简单地像在 string 以外的地方那样写出表达式，然后用花括号 { 和 } 把它括起来即可。示例：
```
//变量
echo "This is {$great}";
echo "This is ${great}";

//数组元素
echo "This works: {$arr['key']}";
echo "This works: {$arr['foo'][3]}";

//对象属性
echo "This square is {$square->width}00 centimeters broad."; 

//方法和对象方法
echo "This is the value of the var named by the return value of getName(): {${getName()}}";
echo "This is the value of the var named by the return value of \$object->getName(): {${$object->getName()}}";

```

##PHP中string的实现

PHP 中的 string 的实现方式是一个由字节组成的数组再加上一个整数指明缓冲区长度。

字符串由什么值来组成并无限制；特别的，其值为 0（“NUL bytes”）的字节可以处于字符串任何位置（不过有几个函数，在本手册中被称为非“二进制安全”的，也许会把 NUL 字节之后的数据全都忽略）。

字符串类型的此特性解释了为什么 PHP 中没有单独的“byte”类型 - 已经用字符串来代替了。返回非文本值的函数 - 例如从网络套接字读取的任意数据 - 仍会返回字符串。

##string和编码

PHP中的string是没有内置编码方式的，也就是说，string可视为原始的二进制字节序列。如何将字节转换成字符的信息，由程序员来决定。

默认地，string字面量会被按照该脚本文件相同的编码方式来编码。不过这并不适用于激活了 Zend Multibyte 的情况；此时脚本可以是以任何方式编码的（明确指定或被自动检测）然后被转换为某种Zend Multibyte定义的内部编码，然后字符串将被用此方式编码。

操作string的函数必须假定字符串是如何编码，有以下几种情况：

- 某些函数假定字符串是以单字节编码的，但并不需要将字节解释为特定的字符。
- 某些函数被传递入了字符串的编码方式，也可能会假定默认无此信息。
- 其它函数使用了当前locale的编码设置（见 setlocale()），但是逐字节操作。
- 一些函数会假定字符串是使用某特定编码的，通常是 UTF-8。
